{
  "Authentication": {
    "JwtSecret": "${JWT_SECRET_KEY}",
    "Issuer": "NeoServiceLayer",
    "Audience": "NeoServiceLayer",
    "AccessTokenExpiryMinutes": 15,
    "RefreshTokenExpiryDays": 30,
    "MaxFailedAttempts": 5,
    "LockoutDurationMinutes": 30,
    "RequireEmailVerification": true,
    "PasswordPolicy": {
      "MinimumLength": 12,
      "RequireUppercase": true,
      "RequireLowercase": true,
      "RequireDigit": true,
      "RequireSpecialCharacter": true,
      "MaximumRepeatingCharacters": 3,
      "ForbiddenPasswords": [
        "password",
        "Password123!",
        "Admin123!",
        "Welcome123!"
      ]
    },
    "Mfa": {
      "Enabled": true,
      "DefaultType": "totp",
      "BackupCodeCount": 8,
      "BackupCodeLength": 8,
      "TotpWindow": 30,
      "TotpSkew": 1
    }
  },
  "RateLimiting": {
    "Enabled": true,
    "EnableIpWhitelist": true,
    "WhitelistedIps": [
      "127.0.0.1",
      "::1"
    ],
    "ExcludedPaths": [
      "/health",
      "/metrics",
      "/swagger"
    ],
    "Rules": {
      "Global": {
        "Limit": 100,
        "Window": 60
      },
      "Login": {
        "Limit": 5,
        "Window": 900
      },
      "Register": {
        "Limit": 3,
        "Window": 3600
      },
      "PasswordReset": {
        "Limit": 3,
        "Window": 3600
      },
      "ApiRead": {
        "Limit": 1000,
        "Window": 60
      },
      "ApiWrite": {
        "Limit": 100,
        "Window": 60
      }
    }
  },
  "SecurityHeaders": {
    "EnableXContentTypeOptions": true,
    "EnableXFrameOptions": true,
    "XFrameOptions": "DENY",
    "EnableXXssProtection": false,
    "EnableHsts": true,
    "HstsMaxAge": 31536000,
    "HstsIncludeSubDomains": true,
    "HstsPreload": true,
    "EnableContentSecurityPolicy": true,
    "ContentSecurityPolicy": "default-src 'self'; script-src 'self' 'nonce-{RANDOM}' 'strict-dynamic'; style-src 'self' 'nonce-{RANDOM}'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self'; object-src 'none'; frame-src 'none'; worker-src 'none'; frame-ancestors 'none'; base-uri 'self'; form-action 'self'; manifest-src 'self'; upgrade-insecure-requests",
    "EnableReferrerPolicy": true,
    "ReferrerPolicy": "strict-origin-when-cross-origin",
    "EnablePermissionsPolicy": true,
    "PermissionsPolicy": "accelerometer=(), ambient-light-sensor=(), autoplay=(), battery=(), camera=(), cross-origin-isolated=(), display-capture=(), document-domain=(), encrypted-media=(), execution-while-not-rendered=(), execution-while-out-of-viewport=(), fullscreen=(), geolocation=(), gyroscope=(), keyboard-map=(), magnetometer=(), microphone=(), midi=(), navigation-override=(), payment=(), picture-in-picture=(), publickey-credentials-get=(), screen-wake-lock=(), sync-xhr=(), usb=(), web-share=(), xr-spatial-tracking=()",
    "EnableXPermittedCrossDomainPolicies": true,
    "RemoveServerHeader": true,
    "RemoveXPoweredByHeader": true,
    "EnableCorsHeaders": false
  },
  "EnhancedSecurity": {
    "EnableContentSecurityPolicy": true,
    "EnableHsts": true,
    "HstsMaxAgeSeconds": 31536000,
    "EnablePermissionsPolicy": true,
    "EnableCrossOriginPolicies": true,
    "EnableSecurityTiming": false
  },
  "IpSecurity": {
    "Enabled": true,
    "Whitelist": [],
    "Blacklist": [],
    "TrustedProxies": [
      "10.0.0.0/8",
      "172.16.0.0/12",
      "192.168.0.0/16"
    ],
    "EnableGeoBlocking": false,
    "AllowedCountries": [],
    "BlockedCountries": [],
    "AllowUnknownCountries": true,
    "CountryRestrictions": [
      {
        "Path": "/api/admin",
        "AllowedCountries": ["US", "CA", "GB", "EU"]
      }
    ],
    "EnableThreatDetection": true,
    "BlockTor": false,
    "BlockVpn": false,
    "BlockProxy": false,
    "BlockHostingProviders": false,
    "MinimumReputationScore": 30,
    "EnableAnomalyDetection": true,
    "BlockSuspiciousActivity": false,
    "MaxRequestsPerMinute": 60
  },
  "AuditLogging": {
    "Enabled": true,
    "MaxRequestBodySize": 4096,
    "MaxResponseBodySize": 4096,
    "WriteToFile": true,
    "LogDirectory": "logs/audit",
    "IncludeStackTrace": false,
    "ExcludedPaths": [
      "/health",
      "/metrics",
      "/swagger",
      "/favicon.ico"
    ],
    "AuditedOperations": [
      "POST:/api/auth/login",
      "POST:/api/auth/logout",
      "POST:/api/auth/register",
      "POST:/api/auth/change-password",
      "POST:/api/auth/reset-password",
      "POST:/api/auth/mfa/enable",
      "POST:/api/auth/mfa/disable",
      "DELETE:",
      "PUT:",
      "PATCH:"
    ],
    "SensitiveFields": [
      "password",
      "confirmPassword",
      "currentPassword",
      "newPassword",
      "secret",
      "token",
      "apiKey",
      "privateKey",
      "creditCard",
      "ssn",
      "socialSecurityNumber"
    ]
  },
  "Security": {
    "Monitoring": {
      "MonitoringInterval": "00:01:00",
      "AnalysisWindowMinutes": 15,
      "AlertCooldownPeriod": "00:30:00",
      "EnableNotifications": true,
      "SecurityNotificationRecipients": [
        "security@neoservicelayer.org",
        "admin@neoservicelayer.org"
      ],
      "BruteForceThreshold": 5,
      "RateLimitAbuseThreshold": 10,
      "AuthenticationFailureRateThreshold": 0.5,
      "DataExfiltrationThreshold": 1000,
      "EnablePerformanceMonitoring": true,
      "EnableSecurityMonitoring": true,
      "EnableAuditMonitoring": true,
      "AlertingEnabled": true,
      "AlertingWebhook": "${ALERTING_WEBHOOK_URL}",
      "MetricsRetention": 90,
      "LogRetention": 30,
      "AuditRetention": 365
    },
    "Logging": {
      "DetailedSecurityLogging": true,
      "SecurityEventRetentionDays": 90,
      "EnableAuditTrail": true,
      "SensitiveDataMasking": true
    },
    "SessionManagement": {
      "SessionTimeout": "00:30:00",
      "MaxConcurrentSessions": 5,
      "RequireSecureConnection": true,
      "EnableSessionFingerprinting": true,
      "SingleSessionPerDevice": false,
      "TrackDeviceFingerprint": true,
      "ExtendOnActivity": true,
      "IdleTimeout": 900
    },
    "Encryption": {
      "Algorithm": "AES-256-GCM",
      "KeyRotationInterval": "90.00:00:00",
      "EnableTransparentEncryption": true
    },
    "EnableCsrfProtection": true,
    "CsrfTokenLength": 32,
    "EnableXssProtection": true,
    "EnableSqlInjectionProtection": true,
    "EnablePathTraversalProtection": true,
    "EnableCommandInjectionProtection": true,
    "MaxUploadSize": 10485760,
    "AllowedFileExtensions": [
      ".pdf",
      ".doc",
      ".docx",
      ".xls",
      ".xlsx",
      ".png",
      ".jpg",
      ".jpeg",
      ".gif",
      ".txt",
      ".csv"
    ],
    "BlockedFileExtensions": [
      ".exe",
      ".dll",
      ".bat",
      ".cmd",
      ".sh",
      ".ps1",
      ".vbs",
      ".js",
      ".jar",
      ".com",
      ".scr"
    ]
  },
  "Cors": {
    "AllowedOrigins": [
      "https://app.neoservicelayer.com",
      "https://admin.neoservicelayer.com"
    ],
    "AllowedMethods": ["GET", "POST", "PUT", "DELETE", "OPTIONS"],
    "AllowedHeaders": ["Content-Type", "Authorization", "X-Request-Id"],
    "AllowCredentials": true,
    "MaxAge": 86400
  }
}